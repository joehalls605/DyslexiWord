<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dyslexia</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
    <div id="app" class="p-10 flex flex-col items-center h-screen text-center">
        <div id="header">
            <h1 class="text-4xl font-bold border-1">Dyslexio</h1>
            <p id="intro-slogan" class="pt-4 text-xl mt-8">Let's put your spelling skills to the test with some frequently misspelled words.</p>
            <button id="startGame" class="text-xl p-2 border-4 w-40 mt-7 " onclick="startGame();">Start Game</button>
        </div>
        <div id="hint-section mt-10">
            <p id="word-hint" class="pt-4 text-2xl hidden mt-8 bg-blue-100 p-8"></p>
        </div>
        <div class="flex flex-row hidden mt-7" id="game"> <!-- Adjusted margin-top from mt-15 to mt-8 -->
            <div id="playSoundButton" class="text-xl p-2 border-4 w-40">
                <audio id="myAudio" ontimeupdate="updateProgressBar()">
                    <source src="">
                </audio>
                <button onclick="playSound()" class="pt-2">Play Sound</button>
                <div id="progressBar" class="h-2 bg-blue-100 mt-1" style="width: 0;"></div>
            </div>
        
          
            <div>
                <input type="text" id="text_input" placeholder="Start typing..." value="" class="text-xl border-4 h-20 ml-3 mr-3 pl-2 pb-1">
            </div>
            
            <div>
                <button id="submitButton" class="text-xl border-4 w-40 pb-6 pt-5" onclick="validateWordInput()">Submit</button>
            </div>
        
        </div>
        <div id="scoreSection"class="bg-blue-100 mt-6 pr-5 pl-5 pb-4 flex flex-row justify-center hidden">
            <p id="scoreHeader" class="mt-5 mr-2 text-xl">Score:</p>
            <p id="score" class="mt-5 mr-2 text-xl"></p>
        </div>
    </div>

    <script>

// Define wordData
const wordData = [
  {_id: "1", word: "acceptable", sound: "./sounds/acceptable.mp3"},
  {_id: "2", word: "accommodate", sound: "./sounds/accommodate.mp3"},
  {_id: "3", word: "drunkenness", sound: "./sounds/drunkenness.mp3"},
  {_id: "4", word: "vicious", sound: "./sounds/vicious.mp3"},
  {_id: "5", word: "acquire", sound: "./sounds/acquire.mp3"},
  {_id: "6", word: "atheist", sound: "./sounds/atheist.mp3"},
  {_id: "7", word: "exhilarate", sound: "./sounds/exhilarate.mp3"},
  {_id: "8", word: "mischievous", sound: "./sounds/mischievous.mp3"},
  {_id: "9", word: "parliament", sound: "./sounds/parliament.mp3"},
  {_id: "10", word: "noticeable", sound: "./sounds/noticeable.mp3"},
  {_id: "11", word: "questionnaire", sound: "./sounds/questionnaire.mp3"},
  {_id: "12", word: "conscience", sound: "./sounds/conscience.mp3"},
  {_id: "13", word: "rhythm", sound: "./sounds/rhythm.mp3"},
  {_id: "14", word: "embarrassment", sound: "./sounds/embarrassment.mp3"},
  {_id: "15", word: "guarantee", sound: "./sounds/guarantee.mp3"},
  {_id: "16", word: "psychiatrist", sound: "./sounds/psychiatrist.mp3"},
  {_id: "17", word: "reconnaissance", sound: "./sounds/reconnaissance.mp3"},
  {_id: "18", word: "incidentally", sound: "./sounds/incidentally.mp3"},
  {_id: "19", word: "sovereignty", sound: "./sounds/sovereignty.mp3"},
  {_id: "20", word: "miscellaneous", sound: "./sounds/miscellaneous.mp3"},
  {_id: "21", word: "pencil", sound: "./sounds/pencil.mp3"}
];


let randomWord;
let score = 0;

randomiseWord();

function startGame(){
    const gameElement = document.getElementById("game");
    gameElement.classList.remove("hidden")
    const startGameElement = document.getElementById("startGame");
    startGameElement.classList.add("hidden");
    const introSloganELement = document.getElementById("intro-slogan");
    introSloganELement.classList.add("hidden");
    const wordHintElement = document.getElementById("word-hint");
    wordHintElement.classList.remove("hidden");
    const scoreSection = document.getElementById("scoreSection");
    scoreSection.classList.remove("hidden");
}


function randomiseWord(){
    // Generating a random index
    const randomIndex = Math.floor(Math.random() * wordData.length);

    // Retrieving a random word from the wordData array using the random index
    randomWord = wordData[randomIndex].word;
    
    const audioSrc = `./sounds/${randomWord}.mp3`;
    console.log(randomWord);
    const audioElement = document.getElementById("myAudio");
    audioElement.setAttribute("src", audioSrc);

    const wordHintElement = document.getElementById("word-hint");
    
    const hintString = randomWord.charAt(0) + "_".repeat(randomWord.length -1);
    wordHintElement.textContent = hintString;
 
}


function validateWordInput() {
  
    const progressBar = document.getElementById("progressBar");
    const playSoundElement = document.getElementById("playSoundButton");
    progressBar.style.width = "0";

    const text_input_element = document.getElementById("text_input");
    const text_input_lowercase = text_input_element.value.toLowerCase();

    const submitButtonElement = document.getElementById("submitButton");
    submitButtonElement.classList.add("border-gray-500");

    const appDivElement = document.getElementById("app");
    const answerOutput = document.getElementById("answerOutput");

    const scoreElement = document.getElementById("score");
    const scoreHeaderElement  = document.getElementById("scoreHeader");



    // UPDATING SUBMIT BUTTON. 
    setTimeout(function(){
        submitButtonElement.classList.remove("border-gray-500");
    }, 100);

    
    // UPDATING OUTPUT - CORRECT

    if(text_input_lowercase === randomWord){
    text_input_element.classList.add("border-green-500");
    text_input_element.value = "";
    text_input_element.placeholder = "Enter a word..."; 
    score ++;
    scoreElement.textContent = score;
    // scoreHeaderElement.classList.remove("hidden");


    setTimeout(function(){
        submitButtonElement.classList.remove("bg-gray-500", "text-white");
        text_input_element.classList.remove("border-green-500");
    }, 1200);


    // UPDATING OUTPUT - INCORRECT

    }
    else{
    text_input_element.classList.add("border-red-500");
    text_input_element.value = "";
    text_input_element.placeholder = "Enter a word..."; 

    setTimeout(function(){
        text_input_element.classList.remove("border-red-500");
    }, 1200);
    }

    randomiseWord();
}

function displayScore(){
    return score;
}


function updateProgressBar(){
    const audio = document.getElementById("myAudio");
    const progressBar = document.getElementById("progressBar");
    const audioDuration = audio.duration;
    const progress = (audio.currentTime / audioDuration) * 100;
    progressBar.style.width = `${progress}%`;
}

function playSound() {
    const playSoundElement = document.getElementById("playSoundButton");
    playSoundElement.classList.add("border-gray-700")
    var audio = document.getElementById("myAudio");
    audio.play();
    setTimeout(function(){
        playSoundElement.classList.remove("border-gray-700")
    }, audio.duration);

}

const btnElement = document.getElementById("submitButton");
btnElement.addEventListener("click", validateWordInput);


    </script>
</body>
</html>
