<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dyslexia</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body>
    <div id="app" class="p-10 flex flex-col items-center h-screen text-center">
        <div class="pb-8">
            <h1 class="text-4xl font-bold">Dyslexio</h1>
            <p id="intro-slogan" class="pt-4 text-xl mt-5">Let's put your spelling skills to the test with some frequently misspelled words.</p>
            <button id="startGame" class="text-xl p-2 border-4 w-40 mt-7" onclick="startGame();">Start Game</button>
        </div>
        <div class="flex flex-row hidden" id="game">
            <div id="playSoundButton" class="text-xl p-2 border-4 w-40">
                <audio id="myAudio" ontimeupdate="updateProgressBar()">
                    <source src="">
                </audio>
                <button onclick="playSound()" class="pt-2">Play Sound</button>
                <div id="progressBar" class="h-2 bg-gray-500 mt-1" style="width: 0;"></div>
            </div>
        
          
            <div>
                <input type="text" id="text_input" placeholder="Start typing..." value="" class="text-xl border-4 h-20 ml-3 mr-3 pl-2 pb-1">
            </div>
            
            <div>
                <button id="submitButton" class="text-xl border-4 w-40 pb-6 pt-5" >Submit</button>
            </div>
        </div>
    </div>

    <script>

// Define wordData
const wordData = [
    {_id: "1", word: "acceptable", sound: "./sounds/acceptable.mp3"},
    {_id: "2", word: "accommodate", sound: "./sounds/accommodate.mp3"},
    {_id: "3", word: "drunkenness", sound: "./sounds/drunkenness.mp3"},
    {_id: "4", word: "vicious", sound: "./sounds/vicious.mp3"},
    {_id: "5", word: "acquire", sound: "./sounds/acquire.mp3"},
    {_id: "6", word: "atheist", sound: "./sounds/atheist.mp3"},
    {_id: "7", word: "exhilarate", sound: "./sounds/exhilarate.mp3"},
    {_id: "8", word: "mischievous", sound: "./sounds/mischievous.mp3"},
    {_id: "9", word: "parliament", sound: "./sounds/parliament.mp3"},
    {_id: "10", word: "noticeable", sound: "./sounds/noticeable.mp3"},
    {_id: "11", word: "questionnaire", sound: "./sounds/questionnaire.mp3"}
];


let randomWord;

randomiseWord();

function startGame(){
    const gameElement = document.getElementById("game");
    gameElement.classList.remove("hidden")
    const startGameElement = document.getElementById("startGame");
    startGameElement.classList.add("hidden");
    const introSloganELement = document.getElementById("intro-slogan");
    introSloganELement.classList.add("hidden");
}


function randomiseWord(){
    // Generating a random index
    const randomIndex = Math.floor(Math.random() * wordData.length);

    // Retrieving a random word from the wordData array using the random index
    randomWord = wordData[randomIndex].word;

    const audioSrc = `./sounds/${randomWord}.mp3`;
    console.log(randomWord);
    const audioElement = document.getElementById("myAudio");
    audioElement.setAttribute("src", audioSrc);
}

// function startGame(){
//     const introSloganELement = document.getElementById("intro-slogan")
//     introSloganELement.textContent = "";
// }

function validateWordInput() {
  
    const progressBar = document.getElementById("progressBar");
    const playSoundElement = document.getElementById("playSoundButton");
    progressBar.style.width = "0";

    const text_input_element = document.getElementById("text_input");
    const text_input_lowercase = text_input_element.value.toLowerCase();
    console.log(text_input_lowercase);

    const submitButtonElement = document.getElementById("submitButton");
    submitButtonElement.classList.add("border-gray-700");


    // UPDATING SUBMIT BUTTON. 
    setTimeout(function(){
        submitButtonElement.classList.remove("border-gray-700");
        answerOutput.classList.remove();
    }, 200);

     
    const appDivElement = document.getElementById("app");
    const answerOutput = document.getElementById("answerOutput");
    
    // UPDATING OUTPUT - CORRECT

    if(text_input_lowercase === randomWord){
    text_input_element.classList.add("border-green-500");

    setTimeout(function(){
        submitButtonElement.classList.remove("bg-gray-500", "text-white");
        text_input_element.classList.remove("border-green-500");
        answerOutput.textContent = "";
    }, 1200);


    // UPDATING OUTPUT - INCORRECT

    }
    else{
    text_input_element.classList.add("border-red-500");

    setTimeout(function(){
        answerOutput.textContent = "";
        text_input_element.classList.remove("border-red-500");

    }, 1200);
    }

    randomiseWord();
}


function updateProgressBar(){
    const audio = document.getElementById("myAudio");
    const progressBar = document.getElementById("progressBar");
    const audioDuration = audio.duration;
    const progress = (audio.currentTime / audioDuration) * 100;
    progressBar.style.width = `${progress}%`;
}

function playSound() {
    const playSoundElement = document.getElementById("playSoundButton");
    playSoundElement.classList.add("border-gray-700")
    var audio = document.getElementById("myAudio");
    audio.play();
    setTimeout(function(){
        playSoundElement.classList.remove("border-gray-700")
    }, audio.duration);

}

const btnElement = document.getElementById("submitButton");
btnElement.addEventListener("click", validateWordInput);


    </script>
</body>
</html>
